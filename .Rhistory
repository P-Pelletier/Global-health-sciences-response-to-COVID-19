size=1,          #border line size
fill="#808080")+
geom_line(size=1.25,aes(x=month,y = Tau, color = "black",group = 1)) +
scale_fill_manual("", breaks = "sd", labels = "Desvio-padrão", values = "grey") +
scale_colour_manual("",
breaks = c("black"),
labels = c("Curva de rarefação"),
values = c("black")) +
labs(title=element_blank(), y="Rank correlation", x=element_blank()) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6),
axis.text.y = element_text(size = 6),
axis.title.x = element_text(size = 6),
axis.title.y = element_text(size = 6),
panel.border = element_rect(colour = "black", fill=NA, size=0.75),
plot.margin = unit(oma2, "cm"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.key=element_blank(),
legend.title=element_blank(),
legend.position="top",
legend.text=element_text(size = 6))+
sxd+
scale_shape_discrete(name  ="Payer",
breaks=c("Female", "Male"),
labels=c("Woman", "Man"))
figc
figc = ggplot(datac) +
geom_ribbon(aes(x=month,ymin=LCI, ymax=UCI,fill="Tau", color = "gray", group = 1),
alpha=0.2,       #transparency
linetype=1,      #solid, dashed or other line types
color="gray", #border line color
size=1,          #border line size
fill="#808080")+
geom_line(size=1.25,aes(x=month,y = Tau, color = "black",group = 1)) +
scale_fill_manual("", breaks = "Tau", labels = "Interval", values = "grey") +
scale_colour_manual("",
breaks = c("black"),
labels = c("Tau"),
values = c("black")) +
labs(title=element_blank(), y="Rank correlation", x=element_blank()) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6),
axis.text.y = element_text(size = 6),
axis.title.x = element_text(size = 6),
axis.title.y = element_text(size = 6),
panel.border = element_rect(colour = "black", fill=NA, size=0.75),
plot.margin = unit(oma2, "cm"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.key=element_blank(),
legend.title=element_blank(),
legend.position="top",
legend.text=element_text(size = 6))+
sxd+
scale_shape_discrete(name  ="Payer",
breaks=c("Female", "Male"),
labels=c("Woman", "Man"))
figc
figc = ggplot(datac) +
geom_ribbon(aes(x=month,ymin=LCI, ymax=UCI,fill="Tau", group = 1),
alpha=0.2,       #transparency
linetype=1,      #solid, dashed or other line types
color="gray", #border line color
size=1,          #border line size
fill="#808080")+
geom_line(size=1.25,aes(x=month,y = Tau, color = "black",group = 1)) +
scale_fill_manual("", breaks = "Tau", labels = "Interval", values = "grey") +
scale_colour_manual("",
breaks = c("black"),
labels = c("Tau"),
values = c("black")) +
labs(title=element_blank(), y="Rank correlation", x=element_blank()) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6),
axis.text.y = element_text(size = 6),
axis.title.x = element_text(size = 6),
axis.title.y = element_text(size = 6),
panel.border = element_rect(colour = "black", fill=NA, size=0.75),
plot.margin = unit(oma2, "cm"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.key=element_blank(),
legend.title=element_blank(),
legend.position="top",
legend.text=element_text(size = 6))+
sxd+
scale_shape_discrete(name  ="Payer",
breaks=c("Female", "Male"),
labels=c("Woman", "Man"))
figc
figc = ggplot(datac) +
geom_ribbon(aes(x=month,ymin=LCI, ymax=UCI,fill="Tau"),
alpha=0.2,       #transparency
linetype=1,      #solid, dashed or other line types
color="gray", #border line color
size=1,          #border line size
fill="#808080")+
geom_line(size=1.25,aes(x=month,y = Tau, color = "black",group = 1)) +
scale_fill_manual("", breaks = "Tau", labels = "Interval", values = "grey") +
scale_colour_manual("",
breaks = c("black"),
labels = c("Tau"),
values = c("black")) +
labs(title=element_blank(), y="Rank correlation", x=element_blank()) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6),
axis.text.y = element_text(size = 6),
axis.title.x = element_text(size = 6),
axis.title.y = element_text(size = 6),
panel.border = element_rect(colour = "black", fill=NA, size=0.75),
plot.margin = unit(oma2, "cm"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.key=element_blank(),
legend.title=element_blank(),
legend.position="top",
legend.text=element_text(size = 6))+
sxd+
scale_shape_discrete(name  ="Payer",
breaks=c("Female", "Male"),
labels=c("Woman", "Man"))
figc
figc = ggplot(datac) +
geom_ribbon(aes(x=month,ymin=LCI, ymax=UCI,fill="Tau", group = 1),
alpha=0.2,       #transparency
linetype=1,      #solid, dashed or other line types
color="gray", #border line color
size=1,          #border line size
fill="#808080")+
geom_line(size=1.25,aes(x=month,y = Tau, color = "black",group = 1)) +
scale_fill_manual("", breaks = "Tau", labels = "Interval", values = "grey") +
scale_colour_manual("",
breaks = c("black"),
labels = c("Tau"),
values = c("black")) +
labs(title=element_blank(), y="Rank correlation", x=element_blank()) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6),
axis.text.y = element_text(size = 6),
axis.title.x = element_text(size = 6),
axis.title.y = element_text(size = 6),
panel.border = element_rect(colour = "black", fill=NA, size=0.75),
plot.margin = unit(oma2, "cm"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.key=element_blank(),
legend.title=element_blank(),
legend.position="top",
legend.text=element_text(size = 6))+
sxd+
scale_shape_discrete(name  ="Payer",
breaks=c("Female", "Male"),
labels=c("Woman", "Man"))
figc
figc = ggplot(datac) +
geom_ribbon(aes(x=month,ymin=LCI, ymax=UCI,fill="Tau", group = 1),
alpha=0.2,       #transparency
linetype=1,      #solid, dashed or other line types
color=NA, #border line color
size=1,          #border line size
fill="#808080")+
geom_line(size=1.25,aes(x=month,y = Tau, color = "black",group = 1)) +
scale_fill_manual("", breaks = "Tau", labels = "Interval", values = "grey") +
scale_colour_manual("",
breaks = c("black"),
labels = c("Tau"),
values = c("black")) +
labs(title=element_blank(), y="Rank correlation", x=element_blank()) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6),
axis.text.y = element_text(size = 6),
axis.title.x = element_text(size = 6),
axis.title.y = element_text(size = 6),
panel.border = element_rect(colour = "black", fill=NA, size=0.75),
plot.margin = unit(oma2, "cm"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.key=element_blank(),
legend.title=element_blank(),
legend.position="top",
legend.text=element_text(size = 6))+
sxd+
scale_shape_discrete(name  ="Payer",
breaks=c("Female", "Male"),
labels=c("Woman", "Man"))
figc
figc = ggplot(datac) +
geom_ribbon(aes(x=month,ymin=LCI, ymax=UCI,fill="Tau", group = 1),
alpha=0.2,       #transparency
linetype=1,      #solid, dashed or other line types
color=NA, #border line color
size=1,          #border line size
fill="#808080")+
geom_line(size=1.25,aes(x=month,y = Tau, color = "black",group = 1)) +
scale_fill_manual(values = c("red", "grey", "seagreen3"))
figc = ggplot(datac) +
geom_ribbon(aes(x=month,ymin=LCI, ymax=UCI,fill="Tau", group = 1),
alpha=0.2,       #transparency
linetype=1,      #solid, dashed or other line types
color=NA, #border line color
size=1,          #border line size
fill="#808080")+
geom_line(size=1.25,aes(x=month,y = Tau, color = "black",group = 1)) +
scale_fill_manual(values = c("red", "grey", "seagreen3"))+
scale_colour_manual("",
breaks = c("black"),
labels = c("Tau"),
values = c("black")) +
labs(title=element_blank(), y="Rank correlation", x=element_blank()) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6),
axis.text.y = element_text(size = 6),
axis.title.x = element_text(size = 6),
axis.title.y = element_text(size = 6),
panel.border = element_rect(colour = "black", fill=NA, size=0.75),
plot.margin = unit(oma2, "cm"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.key=element_blank(),
legend.title=element_blank(),
legend.position="top",
legend.text=element_text(size = 6))+
sxd+
scale_shape_discrete(name  ="Payer",
breaks=c("Female", "Male"),
labels=c("Woman", "Man"))
figc
figc = ggplot(datac) +
geom_ribbon(aes(x=month,ymin=LCI, ymax=UCI,fill="Tau", group = 1),
alpha=0.2,       #transparency
linetype=1,      #solid, dashed or other line types
color=NA, #border line color
size=1,          #border line size
fill="#808080")+
geom_line(size=1.25,aes(x=month,y = Tau, color = "black",group = 1)) +
scale_fill_manual(values = c("red", "grey", "seagreen3"))+
scale_colour_manual("",
breaks = c("black"),
labels = c("Tau"),
values = c("black")) +
labs(title=element_blank(), y="Rank correlation", x=element_blank()) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6),
axis.text.y = element_text(size = 6),
axis.title.x = element_text(size = 6),
axis.title.y = element_text(size = 6),
panel.border = element_rect(colour = "black", fill=NA, size=0.75),
plot.margin = unit(oma2, "cm"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.key=element_blank(),
legend.title=element_blank(),
legend.position="top",
legend.text=element_text(size = 6))+
sxd
figc
figc = ggplot(datac) +
geom_ribbon(aes(x=month,ymin=LCI, ymax=UCI,fill="Tau", group = 1),
alpha=0.2,       #transparency
linetype=1,      #solid, dashed or other line types
color=NA, #border line color
size=1,          #border line size
fill="#808080")+
scale_fill_manual(values = c("red", "grey", "seagreen3"))
figc
figc = ggplot(datac) +
geom_ribbon(aes(x=month,ymin=LCI, ymax=UCI,fill="Tau", group = 1),
alpha=0.2,       #transparency
linetype=1,      #solid, dashed or other line types
color=NA, #border line color
size=1,          #border line size
fill="#808080")+
geom_line(size=1.25,aes(x=month,y = Tau, color = "black",group = 1)) +
scale_fill_manual(values = c("red", "grey", "seagreen3"))+
scale_colour_manual("",
breaks = c("black"),
labels = c("Tau"),
values = c("black")) +
labs(title=element_blank(), y="Rank correlation", x=element_blank()) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6),
axis.text.y = element_text(size = 6),
axis.title.x = element_text(size = 6),
axis.title.y = element_text(size = 6),
panel.border = element_rect(colour = "black", fill=NA, size=0.75),
plot.margin = unit(oma2, "cm"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.key=element_blank(),
legend.title=element_blank(),
legend.position="top",
legend.text=element_text(size = 6))+
sxd
figc
figc = ggplot(datac) +
geom_ribbon(aes(x=month,ymin=LCI, ymax=UCI,fill="Tau", group = 1),
alpha=0.2,       #transparency
linetype=1,      #solid, dashed or other line types
color=NA, #border line color
size=1,          #border line size
fill="#808080")+
geom_line(size=1.25,aes(x=month,y = Tau, color = "black",group = 1)) +
scale_fill_manual(values = c("red", "grey", "seagreen3"))+
scale_colour_manual("",
breaks = c("black"),
labels = c("Tau"),
values = c("black")) +
labs(title=element_blank(), y="Rank correlation", x=element_blank()) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6),
axis.text.y = element_text(size = 6),
axis.title.x = element_text(size = 6),
axis.title.y = element_text(size = 6),
panel.border = element_rect(colour = "black", fill=NA, size=0.75),
plot.margin = unit(oma2, "cm"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.key=element_blank(),
legend.title=element_blank(),
legend.position="top",
legend.text=element_text(pointsize = 6))+
sxd
figc = ggplot(datac) +
geom_ribbon(aes(x=month,ymin=LCI, ymax=UCI,fill="Tau", group = 1),
alpha=0.2,       #transparency
linetype=1,      #solid, dashed or other line types
color=NA, #border line color
size=1,          #border line size
fill="#808080")+
geom_line(size=1.25,aes(x=month,y = Tau, color = "black",group = 1)) +
scale_fill_manual(values = c("red", "grey", "seagreen3"))+
scale_colour_manual("",
breaks = c("black"),
labels = c("Tau"),
values = c("black")) +
labs(title=element_blank(), y="Rank correlation", x=element_blank()) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6),
axis.text.y = element_text(size = 6),
axis.title.x = element_text(size = 6),
axis.title.y = element_text(size = 6),
panel.border = element_rect(colour = "black", fill=NA, size=0.75),
plot.margin = unit(oma2, "cm"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.key=element_blank(),
legend.title=element_blank(),
legend.position="top",
legend.text=element_text(size = 6))+
sxd
figc
fig1 = ggdraw() +
draw_plot(figa, x=0, y=1.75/3, width=1/3, height=1.5/3)+
draw_image(figb, x=1/3, y=1.75/3, width=1/3, height=1.5/3)+
draw_image(figc, x=2/3, y=1.75/3, width=1/3, height=1.5/3)+
draw_image(img, x=0, y=0, width=1/2, height=1.25/3)+
draw_image(img, x=1/2, y=0, width=1/2, height=1.25/3)+
draw_plot_label(label=c("A","B", "C", "D","E"),x=c(0, 1/3, 2/3, 0, 1/2),y=c(0.90, 1, 1, 1/3,1/3),
size = 10)
img = "D:/Github/Global-health-sciences-response-to-COVID-19/Results_2021/3d_2021.png"
fig1 = ggdraw() +
draw_plot(figa, x=0, y=1.75/3, width=1/3, height=1.5/3)+
draw_image(figb, x=1/3, y=1.75/3, width=1/3, height=1.5/3)+
draw_image(figc, x=2/3, y=1.75/3, width=1/3, height=1.5/3)+
draw_image(img, x=0, y=0, width=1/2, height=1.25/3)+
draw_image(img, x=1/2, y=0, width=1/2, height=1.25/3)+
draw_plot_label(label=c("A","B", "C", "D","E"),x=c(0, 1/3, 2/3, 0, 1/2),y=c(0.90, 1, 1, 1/3,1/3),
size = 10)
fig1 = ggdraw() +
draw_plot(figa, x=0, y=1.75/3, width=1/3, height=1.5/3)+
draw_plot(figb, x=1/3, y=1.75/3, width=1/3, height=1.5/3)+
draw_plot(figc, x=2/3, y=1.75/3, width=1/3, height=1.5/3)+
draw_image(img, x=0, y=0, width=1/2, height=1.25/3)+
draw_image(img, x=1/2, y=0, width=1/2, height=1.25/3)+
draw_plot_label(label=c("A","B", "C", "D","E"),x=c(0, 1/3, 2/3, 0, 1/2),y=c(0.90, 1, 1, 1/3,1/3),
size = 10)
filename <- "D:/Github/Global-health-sciences-response-to-COVID-19/Results_2021/Fig1.pdf"
pdf(file=filename, width=6.5, height=5.5, family="Helvetica")
fig1
dev.off()
fig1
fig1 = ggdraw() +
draw_plot(figa, x=0, y=1.75/3, width=1/3, height=1.5/3)+
draw_plot(figb, x=1/3, y=1.75/3, width=1/3, height=1.5/3)+
draw_plot(figc, x=2/3, y=1.75/3, width=1/3, height=1.5/3)+
draw_image(img, x=0, y=0, width=1/2, height=1.25/3)+
draw_image(img, x=1/2, y=0, width=1/2, height=1.25/3)+
draw_plot_label(label=c("A","B", "C", "D","E"),x=c(0, 1/3, 2/3, 0, 1/2),y=c(0.95, 1, 1, 1/3,1/3),
size = 10)
fig1
fig1 = ggdraw() +
draw_plot(figa, x=0, y=1.75/3, width=1/3, height=1.5/3)+
draw_plot(figb, x=1/3, y=1.75/3, width=1/3, height=1.5/3)+
draw_plot(figc, x=2/3, y=1.75/3, width=1/3, height=1.5/3)+
draw_image(img, x=0, y=0, width=1/2, height=1.25/3)+
draw_image(img, x=1/2, y=0, width=1/2, height=1.25/3)+
draw_plot_label(label=c("A","B", "C", "D","E"),x=c(0, 1/3, 2/3, 0, 1/2),y=c(0.99, 1, 1, 1/3,1/3),
size = 10)
fig1
fig1 = ggdraw() +
draw_plot(figa, x=0, y=1.75/3, width=1/3, height=1.5/3)+
draw_plot(figb, x=1/3, y=1.75/3, width=1/3, height=1.5/3)+
draw_plot(figc, x=2/3, y=1.75/3, width=1/3, height=1.5/3)+
draw_image(img, x=0, y=0, width=1/2, height=1.25/3)+
draw_image(img, x=1/2, y=0, width=1/2, height=1.25/3)+
draw_plot_label(label=c("A","B", "C", "D","E"),x=c(0, 1/3, 2/3, 0, 1/2),y=c(0.99, 0.99, 0.99, 1/3,1/3),
size = 10)
fig1
fig1 = ggdraw() +
draw_plot(figa, x=0, y=1.75/3, width=1/3, height=1.6/3)+
draw_plot(figb, x=1/3, y=1.75/3, width=1/3, height=1.5/3)+
draw_plot(figc, x=2/3, y=1.75/3, width=1/3, height=1.5/3)+
draw_image(img, x=0, y=0, width=1/2, height=1.25/3)+
draw_image(img, x=1/2, y=0, width=1/2, height=1.25/3)+
draw_plot_label(label=c("A","B", "C", "D","E"),x=c(0, 1/3, 2/3, 0, 1/2),y=c(0.99, 0.99, 0.99, 1/3,1/3),
size = 10)
fig1
fig1 = ggdraw() +
draw_plot(figa, x=0, y=1.75/3, width=1/3, height=1.4/3)+
draw_plot(figb, x=1/3, y=1.75/3, width=1/3, height=1.5/3)+
draw_plot(figc, x=2/3, y=1.75/3, width=1/3, height=1.5/3)+
draw_image(img, x=0, y=0, width=1/2, height=1.25/3)+
draw_image(img, x=1/2, y=0, width=1/2, height=1.25/3)+
draw_plot_label(label=c("A","B", "C", "D","E"),x=c(0, 1/3, 2/3, 0, 1/2),y=c(0.99, 0.99, 0.99, 1/3,1/3),
size = 10)
fig1
fig1 = ggdraw() +
draw_plot(figa, x=0, y=1.75/3, width=1/3, height=1.4/3)+
draw_plot(figb, x=1/3, y=1.75/3, width=1/3, height=1.4/3)+
draw_plot(figc, x=2/3, y=1.75/3, width=1/3, height=1.4/3)+
draw_image(img, x=0, y=0, width=1/2, height=1.25/3)+
draw_image(img, x=1/2, y=0, width=1/2, height=1.25/3)+
draw_plot_label(label=c("A","B", "C", "D","E"),x=c(0, 1/3, 2/3, 0, 1/2),y=c(0.99, 0.99, 0.99, 1/3,1/3),
size = 10)
fig1
# clear memory #
rm(list = ls()) ; gc();gc();gc();gc();gc(); ls(); search()
# load libraries #
library(igraph)
library(RColorBrewer)
library(lattice)
library(tikzDevice)
library(ggplot2)
library(cowplot)
library(magick)
library(scales)
library(zoo)
library(countrycode)
library(reshape2)
setwd("D:/Github/Global-health-sciences-response-to-COVID-19")
dataa = read.csv(file="Data/Data_2020/fig1a.csv",
header=TRUE,sep=",",stringsAsFactors = FALSE)
datab = read.csv(file="Data/Data_2020/fig1b.csv",
header=TRUE,sep=",",stringsAsFactors = FALSE)
datac = read.csv(file="Data/Data_2020/fig1c.csv",
header=TRUE,sep=",",stringsAsFactors = FALSE)
# plot 1 ####
months = unique(dataa$month)
sxd <- scale_x_discrete(breaks=c(months[1],months[7],months[13],months[16]),
labels = c("Jan 2019","July 2019", "Jan 2020","April 2020" ))
oma2 <- c(0.3,0,0,0)
figa = ggplot(dataa, aes(month)) +
geom_line(size=1.25,aes(y = Coronavirus, colour = "Coronavirus",group = 1)) +
geom_line(size=1.25,aes(y = non_Coronavirus, colour = "non_Coronavirus",group = 1))+
geom_vline(xintercept = 12,linetype="dashed") +
scale_color_manual(values=c('#ff7f0e','#1f77b4'))+
labs(title=element_blank(), y="Number of papers", x=element_blank()) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6),
axis.text.y = element_text(size = 6),
axis.title.x = element_text(size = 6),
axis.title.y = element_text(size = 6),
panel.border = element_rect(colour = "black", fill=NA, size=0.75),
plot.margin = unit(oma2, "cm"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.key=element_blank(),
legend.title=element_blank(),
legend.position="top",
legend.text=element_text(size = 6)) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x))) +
sxd
figa
ggsave("Results/Results_2020/fig1a.png", plot = figa)
# plot 2 ####
colnames(datab) <- c("pre Covid-19","Covid-19","country")
datab$country = countrycode(datab$country, origin ='country.name', destination ='iso3c')
datab <- melt(datab, id = "country")
datab
figb = ggplot(datab) +
geom_bar(aes(x = country, y = value, fill = variable), position = "dodge", stat = "identity")+
scale_fill_manual(values=c("#8B008B", "#696969")) +
labs(title=element_blank(), y="Coronavirus papers", x=element_blank()) +
theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6),
axis.text.y = element_text(size = 6),
axis.title.x = element_text(size = 6),
axis.title.y = element_text(size = 6),
panel.border = element_rect(colour = "black", fill=NA, size=0.75),
plot.margin = unit(oma2, "cm"),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_blank(),
legend.key=element_blank(),
legend.title=element_blank(),
legend.position="top",
legend.text=element_text(size = 6)) +
scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),
labels = trans_format("log10", math_format(10^.x)))+
expand_limits(x = 0, y = 0)
figb
